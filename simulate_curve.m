clear all
clc


x=160:10:400;
y1=[270.8114
174.9098
123.3772
93.3914
75.728
65.4204
59.9592
56.2996
54.0856
51.9606
50.5986
49.4782
48.51
47.4864
46.8602
45.792
45.4172
44.7624
44.2788
43.541
43.2152
42.563
42.181
41.57
41.015
];
y1=y1';

y2=[119.401
81.4148
62.286
51.1416
44.2546
40.5884
38.4402
37.1878
35.9684
35.232
34.1948
33.6392
32.8836
32.5126
31.9282
31.4762
31.1514
30.5892
30.181
29.8134
29.3592
28.948
28.6806
28.4478
27.8022
];
y2=y2';

y3=[55.087
37.9798
29.557
24.4904
21.3638
19.699
18.876
18.1468
17.7388
17.0824
16.965
16.6342
16.2994
15.881
15.925
15.5692
15.4164
15.0596
14.9592
14.6818
14.478
14.2584
14.0936
14.0008
13.7678
];
y3=y3';
xx=160:400;

co=polyfit(x,y1,5);
y30=co(1)*xx.^5+co(2)*xx.^4+co(3)*xx.^3+co(4)*xx.^2+co(5)*xx+co(6);
y301=5*co(1)*xx.^4+4*co(2)*xx.^3+3*co(3)*xx.^2+2*co(4)*xx.^1+co(5);
y302=20*co(1)*xx.^3+12*co(2)*xx.^2+6*co(3)*xx+2*co(4);
y303=60*co(1)*xx.^2+24*co(2)*xx+co(3);
y304=120*co(1)*xx+24;

co=polyfit(x,y2,5);

y20=co(1)*xx.^5+co(2)*xx.^4+co(3)*xx.^3+co(4)*xx.^2+co(5)*xx+co(6);
y201=5*co(1)*xx.^4+4*co(2)*xx.^3+3*co(3)*xx.^2+2*co(4)*xx.^1+co(5);
y202=20*co(1)*xx.^3+12*co(2)*xx.^2+6*co(3)*xx+2*co(4);
y203=60*co(1)*xx.^2+24*co(2)*xx+co(3);
y204=120*co(1)*xx+24;


co=polyfit(x,y3,5);

y10=co(1)*xx.^5+co(2)*xx.^4+co(3)*xx.^3+co(4)*xx.^2+co(5)*xx+co(6);
y101=5*co(1)*xx.^4+4*co(2)*xx.^3+3*co(3)*xx.^2+2*co(4)*xx.^1+co(5);
y102=20*co(1)*xx.^3+12*co(2)*xx.^2+6*co(3)*xx+2*co(4);
y103=60*co(1)*xx.^2+24*co(2)*xx+co(3);
y104=120*co(1)*xx+24;

a=diff(y1,3);
[m,i]=max(a)

% K=abs(yy2)./((1+yy1.^2).^1.5);
% K=1./K;
% K1=diff(K,1);
% xx1=1:150;

subplot(2,2,1)
plot(xx,y30,'r',x,y1,'b')
hleg1 = legend('拟合数据','测量数据');
subplot(2,2,2)
plot(xx,y20,'r',x,y2,'b')
hleg1 = legend('拟合数据','测量数据');
subplot(2,2,3)
plot(xx,y10,'r',x,y3,'b')
hleg1 = legend('拟合数据','测量数据');
subplot(2,2,4)
plot(xx,y303,'r')

[ma,i1]=max(y302);
[ma,i2]=max(y202);
[ma,i3]=max(y102);

